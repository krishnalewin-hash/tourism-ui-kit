<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Tour Detection Issue</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px;
            min-height: 200vh;
        }
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 300px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            font-size: 12px;
            z-index: 10000;
            max-height: 400px;
            overflow-y: auto;
        }
        .status-item {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .form-container {
            margin-top: 50px;
        }
    </style>
</head>
<body>
    <div class="debug-panel">
        <h4>üîç Debug Status</h4>
        <div id="debug-output">Loading...</div>
    </div>

    <h1>Blue Mountain Adventure Tour</h1>
    <p>This page should detect as a tour and hide the drop-off field.</p>
    
    <div class="form-container">
        <!-- Simulate a GoHighLevel form structure -->
        <div id="_builder-form">
            <div class="ghl-form-row">
                <label for="pickup">Pickup Location:</label>
                <input name="pickup_location" id="pickup" placeholder="Enter pickup location">
            </div>
            <div class="ghl-form-row">
                <label for="dropoff">Drop-off Location:</label>
                <input name="dropoff_location" data-name="dropoff_location" id="dropoff" placeholder="Enter drop-off location">
            </div>
            <div class="ghl-form-row">
                <label for="date">Date:</label>
                <input name="pickup_date" id="date" type="date">
            </div>
            <button type="submit">Get Quote</button>
        </div>
    </div>

    <!-- Your exact embed code -->
    <script>
        // Debug logging override
        const originalLog = console.log;
        const logs = [];
        console.log = function(...args) {
            logs.push(args.join(' '));
            originalLog.apply(console, arguments);
            updateDebugPanel();
        };
        
        // Configuration
        window.CFG = {client: 'kamar-tours', formType: 'tour'};
        console.log('üîß CFG set:', JSON.stringify(window.CFG));
    </script>
    
    <script src="https://cdn.jsdelivr.net/gh/krishnalewin-hash/tourism-ui-kit@main/dist/quote-request-form.min.js"></script>
    
    <script>
        function updateDebugPanel() {
            const output = document.getElementById('debug-output');
            if (!output) return;
            
            const dropoffField = document.querySelector('[data-name="dropoff_location"], [name="dropoff_location"]');
            const form = document.querySelector('#_builder-form');
            const bodyClasses = document.body.className;
            
            let html = '<div class="status-item"><strong>Configuration:</strong><br>';
            html += `window.CFG: ${JSON.stringify(window.CFG || {}, null, 2)}</div>`;
            
            html += '<div class="status-item"><strong>Body Classes:</strong><br>';
            html += `${bodyClasses || 'No classes'}</div>`;
            
            if (dropoffField) {
                const computed = getComputedStyle(dropoffField);
                const isHidden = computed.display === 'none';
                html += `<div class="status-item ${isHidden ? 'success' : 'error'}">`;
                html += `<strong>Drop-off Field:</strong><br>`;
                html += `Display: ${computed.display}<br>`;
                html += `Visibility: ${computed.visibility}<br>`;
                html += `Height: ${computed.height}<br>`;
                html += `Value: "${dropoffField.value}"</div>`;
            } else {
                html += '<div class="status-item error"><strong>Drop-off Field:</strong><br>NOT FOUND</div>';
            }
            
            if (form) {
                const computed = getComputedStyle(form);
                html += `<div class="status-item ${computed.position === 'sticky' ? 'success' : 'error'}">`;
                html += `<strong>Form Position:</strong><br>`;
                html += `Position: ${computed.position}<br>`;
                html += `Top: ${computed.top}</div>`;
            } else {
                html += '<div class="status-item error"><strong>Form:</strong><br>NOT FOUND</div>';
            }
            
            html += '<div class="status-item"><strong>Console Logs:</strong><br>';
            html += logs.slice(-10).map(log => `‚Ä¢ ${log}`).join('<br>') + '</div>';
            
            output.innerHTML = html;
        }
        
        // Update every 500ms
        setInterval(updateDebugPanel, 500);
        
        // Also update after key events
        setTimeout(updateDebugPanel, 100);
        setTimeout(updateDebugPanel, 1000);
        setTimeout(updateDebugPanel, 3000);
        
        // Listen for DOM changes
        const observer = new MutationObserver(updateDebugPanel);
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            attributeFilter: ['class', 'style']
        });
    </script>
</body>
</html>