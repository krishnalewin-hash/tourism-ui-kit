<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Quote Calculator Test</title>
    <style>
        body {
            margin: 20px;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }
        .test-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }
        #quote-calc {
            min-height: 200px;
            background: white;
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
        }
        .error-display {
            background: #fee;
            color: #c00;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h2>Quote Calculator Test</h2>
        <p><strong>Status:</strong> <span id="status">Loading...</span></p>
        <p><strong>URL Parameters:</strong></p>
        <ul id="params-list"></ul>
        <div id="error-log"></div>
    </div>

    <!-- Mount point for quote calculator -->
    <div id="quote-calc">
        <p>Quote calculator should load here...</p>
    </div>

    <script>
        // Basic error handling
        window.addEventListener('error', function(e) {
            document.getElementById('error-log').innerHTML += 
                `<div class="error-display">JavaScript Error: ${e.message} at ${e.filename}:${e.lineno}</div>`;
        });

        // Display URL parameters
        const params = new URLSearchParams(window.location.search);
        const paramsList = document.getElementById('params-list');
        if (params.toString()) {
            for (const [key, value] of params) {
                paramsList.innerHTML += `<li><strong>${key}:</strong> ${value}</li>`;
            }
        } else {
            paramsList.innerHTML = '<li>No parameters - try adding ?pickup_location=MBJ&dropoff_location=Negril&passengers=2</li>';
        }

        // Set up Google Maps configuration
        window.CFG = {
            GMAPS_KEY: "AIzaSyD4gsEcGYTjqAILBU0z3ZNqEwyODGymXjA"
        };

        // Status updates
        document.getElementById('status').textContent = 'Configuration set, loading quote calculator...';

        // Check if quote calc loads
        setTimeout(() => {
            if (window.QuoteCalc) {
                document.getElementById('status').textContent = 'Quote calculator loaded successfully!';
            } else {
                document.getElementById('status').textContent = 'Quote calculator failed to load';
                document.getElementById('error-log').innerHTML += 
                    '<div class="error-display">Quote calculator script did not execute properly</div>';
            }
        }, 3000);
    </script>

    <!-- Load quote calculator CSS -->
    <link rel="stylesheet" href="../dist/quote-calc.css">
    
    <!-- Load quote calculator JavaScript -->
    <script src="../dist/quote-calc.js"></script>

    <!-- Test button to manually trigger -->
    <script>
        setTimeout(() => {
            if (window.QuoteCalc && window.QuoteCalc.run) {
                document.getElementById('status').textContent += ' - Triggering manual run...';
                try {
                    window.QuoteCalc.run();
                } catch (error) {
                    document.getElementById('error-log').innerHTML += 
                        `<div class="error-display">Manual run error: ${error.message}</div>`;
                }
            }
        }, 4000);
    </script>
</body>
</html>