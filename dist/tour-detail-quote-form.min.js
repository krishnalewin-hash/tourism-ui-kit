// Enhanced Quote Request Form with Tour Detail Support
// Supports: hideDropoff, stickyForm, prefillDropoff parameters

(function() {
  'use strict';

  // Tour Detail Enhancement Module
  function initTourDetailEnhancements() {
    const cfg = window.CFG || {};
    
    // 1. Hide dropoff field if requested
    if (cfg.hideDropoff) {
      const style = document.createElement('style');
      style.textContent = `
        [data-q="drop-off_location"], 
        [data-q="dropoff_location"],
        .form-field-wrapper:has([data-q="drop-off_location"]),
        .form-field-wrapper:has([data-q="dropoff_location"]) {
          display: none !important;
        }
      `;
      document.head.appendChild(style);
    }

    // 2. Add sticky form positioning if requested
    if (cfg.stickyForm) {
      const style = document.createElement('style');
      const selector = cfg.stickySelector || '.form-sidebar';
      style.textContent = `
        /* Tour Detail Sticky Form Styles */
        body { 
          overflow-x: clip; 
          overflow-y: visible !important; 
        }
        
        ${selector} {
          position: sticky !important;
          top: 24px;
          align-self: flex-start;
        }
        
        /* Include all the styling from your original CSS */
        .ghl-btn.ghl-submit-btn.bf-cta .bf-cta-text {
          font-size: 20px !important;
        }

        #_builder-form .thank-you-message > div {
          padding: 40px 0px !important;
        }

        .social-icon {
          padding: 0.3rem !important;
        }

        .gradientbg {
          background: linear-gradient(to bottom, #ffffff 0%, #F6F5F8 100%);
        }

        /* Google Places Autocomplete improvements for tour detail */
        .pac-container {
          font-family: 'Poppins', sans-serif;
          font-size: 1.05rem;
          line-height: 1.35;
          border: 2px solid #ddd;
          border-radius: 10px;
          box-shadow: 0 6px 18px rgba(0,0,0,.15);
          overflow: hidden;
          z-index: 4000;
        }
        
        .pac-container:empty {
          display: none;
        }
        
        .pac-item {
          padding: 10px 14px;
          font-size: 0.92rem;
          line-height: 1.25;
          cursor: pointer;
          border-top: 1px solid #efefef;
          background: #fff;
          color: #222;
        }
        
        .pac-item:first-child {
          border-top: none;
        }
        
        .pac-item .pac-item-query {
          display: block;
          font-size: 1.18rem;
          font-weight: 600;
          line-height: 1.1;
          margin: 0 0 2px 0;
          color: #222;
        }
        
        .pac-item .pac-item-query ~ span {
          display: inline;
          font-size: 0.85rem;
          font-weight: 400;
          color: #555;
        }
        
        .pac-item:hover,
        .pac-item.pac-item-selected {
          background: #266BBC;
          color: #fff;
        }
        
        .pac-item:hover .pac-item-query,
        .pac-item.pac-item-selected .pac-item-query {
          color: #fff;
        }
        
        .pac-item:hover .pac-item-query ~ span,
        .pac-item.pac-item-selected .pac-item-query ~ span {
          color: #fff;
        }
        
        .pac-icon {
          width: 18px;
          height: 18px;
          margin-right: 8px;
        }
        
        .pac-container .pac-logo:after {
          display: none;
        }
        
        @media (max-width: 600px) {
          .pac-container {
            font-size: 1.12rem;
          }
          .pac-item {
            padding: 12px 16px;
          }
          .pac-item .pac-item-query {
            font-size: 1.2rem;
          }
          .pac-item .pac-item-query ~ span {
            font-size: 0.88rem;
          }
          
          form#_builder-form {
            padding: 0px 10px !important;
            border-top-left-radius: 10px !important;
            border-top-right-radius: 10px !important;
          }
        }
        
        @media (min-width:640px){
          .ghl-question .fields-container.row{
            display:flex !important;
            flex-wrap:wrap !important;
            gap: 0px 5px;
            align-items:flex-start;
          }
          
          .ghl-question .fields-container.row > .form-field-wrapper{
            width:100%;
            max-width:100%;
            flex: 0 0 100%;
            box-sizing:border-box;
          }
          
          .ghl-question .fields-container.row > .form-field-wrapper:has([data-q="pickup_date"]),
          .ghl-question .fields-container.row > .form-field-wrapper:has([data-q="pickup_time"]){
            width: calc(50% - 3px) !important;
            max-width: calc(50% - 3px) !important;
            flex: 0 0 calc(50% - 3px) !important;
          }
        }
        
        #lc-form-mount .ghl-form-wrap {
          margin-bottom: 0 !important;
        }
      `;
      document.head.appendChild(style);
    }

    // 3. Auto-fill dropoff from page title if requested
    if (cfg.prefillDropoff || cfg.hideDropoff) {
      function getBestTitle() {
        const raw = document.querySelector('meta[property="og:title"]')?.content || document.title || '';
        const parts = raw.split(/ [|\-–•>]+ /);
        let t = (parts[0] || raw || '').trim();
        if (!t) {
          const h1 = document.querySelector('h1');
          t = h1 ? h1.textContent.trim() : '';
        }
        t = t.replace(/\s+/g, ' ').replace(/[|–\-•]+$/,'').trim();
        return t;
      }

      function autofillDropoff() {
        const el = document.querySelector('[data-q="drop-off_location"], [data-q="dropoff_location"]');
        if (!el || el.dataset.dropAutoFilled === '1') return;
        
        const current = (el.value || '').trim();
        if (current) { 
          el.dataset.dropAutoFilled = '1'; 
          return; 
        }

        const title = getBestTitle();
        if (!title) return;

        // Set value and trigger events
        el.value = title;
        el.setAttribute('value', title);
        el.dispatchEvent(new Event('input', { bubbles: true }));
        el.dispatchEvent(new Event('change', { bubbles: true }));
        el.dataset.dropAutoFilled = '1';
        
        console.log('[TourDetail] Auto-filled dropoff location:', title);
      }

      // Initial fill
      autofillDropoff();
      
      // Watch for late-rendered fields
      const observer = new MutationObserver(() => {
        autofillDropoff();
      });
      observer.observe(document.body, { childList: true, subtree: true });
      
      // Also watch for title changes
      let lastTitle = document.title;
      setInterval(() => {
        if (document.title !== lastTitle) {
          lastTitle = document.title;
          const el = document.querySelector('[data-q="drop-off_location"], [data-q="dropoff_location"]');
          if (el && !(el.value || '').trim()) {
            el.dataset.dropAutoFilled = '';
            autofillDropoff();
          }
        }
      }, 1000);
    }
  }

  // Initialize tour detail enhancements immediately
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initTourDetailEnhancements);
  } else {
    initTourDetailEnhancements();
  }

})();

// Load the base quote-request-form functionality
var TourBooking=(()=>{window.BookingForm=window.BookingForm||{};async function q(){if(console.log("[ConfigLoader] Starting configuration loading..."),window.CFG?.GMAPS_KEY&&window.CFG?.configLoaded)return console.log("[ConfigLoader] Using pre-loaded configuration"),window.CFG;let n=window.CFG?.client||new URLSearchParams(location.search).get("client")||sessionStorage.getItem("client")||"demo",o=window.CFG?.base||"krishnalewin-hash/tourism-ui-kit@main";console.log(`[ConfigLoader] Loading configuration for client: ${n}`),console.log(`[ConfigLoader] Base URL: ${o}`);try{let t;o.startsWith("../")||o.startsWith("./")||o.startsWith("/")?t=`${o}/clients/${n}/core/config.json`:t=`https://cdn.jsdelivr.net/gh/${o}/clients/${n}/core/config.json`,console.log(`[ConfigLoader] Fetching: ${t}`);let s=await fetch(t,{cache:"no-store"});if(s.ok){let e=await s.json();return window.CFG={...window.CFG,...e.FORM_CONFIG,GMAPS_KEY:e.FORM_CONFIG?.GMAPS_KEY,COUNTRIES:e.FORM_CONFIG?.COUNTRIES,CURRENCY:e.FORM_CONFIG?.CURRENCY,PLACES:e.FORM_CONFIG?.PLACES,FIELD_MAPPING:e.FORM_CONFIG?.FIELD_MAPPING,configLoaded:!0,loadedFrom:"built-config"},console.log(`[ConfigLoader] Successfully loaded ${n} configuration from built config`),window.CFG}else console.log(`[ConfigLoader] Built config returned ${s.status}: ${s.statusText}`)}catch(t){console.log(`[ConfigLoader] Built config fetch failed: ${t.message}`)}try{let t;o.startsWith("../")||o.startsWith("./")||o.startsWith("/")?t=`${o}/clients/${n}.json`:t=`https://cdn.jsdelivr.net/gh/${o}/clients/${n}.json`,console.log(`[ConfigLoader] Trying legacy config: ${t}`);let s=await fetch(t,{cache:"no-store"});if(s.ok){let e=await s.json();return window.CFG={...window.CFG,...e.FORM_CONFIG,GMAPS_KEY:e.FORM_CONFIG?.GMAPS_KEY,COUNTRIES:e.FORM_CONFIG?.COUNTRIES,CURRENCY:e.FORM_CONFIG?.CURRENCY,PLACES:e.FORM_CONFIG?.PLACES,FIELD_MAPPING:e.FORM_CONFIG?.FIELD_MAPPING,configLoaded:!0,loadedFrom:"legacy-config"},console.log(`[ConfigLoader] Successfully loaded ${n} configuration from legacy config`),window.CFG}else console.log(`[ConfigLoader] Legacy config returned ${s.status}: ${s.statusText}`)}catch(t){console.log(`[ConfigLoader] Legacy config fetch failed: ${t.message}`)}return console.warn(`[ConfigLoader] No configuration found for ${n}, using defaults`),window.CFG={...window.CFG,GMAPS_KEY:window.CFG?.GMAPS_KEY||"AIzaSyD4gsEcGYTjqAILBU0z3ZNqEwyODGymXjA",COUNTRIES:window.CFG?.COUNTRIES||["jm"],CURRENCY:window.CFG?.CURRENCY||"USD",PLACES:{FIELDS:["place_id","formatted_address","geometry","name","types"],TYPES:["establishment"],...window.CFG?.PLACES||{}},configLoaded:!0,loadedFrom:"defaults"},window.CFG}async function S(){try{await q(),console.log(`[BookingForm] Configuration loaded from: ${window.CFG.loadedFrom}`),console.log(`[BookingForm] GMAPS_KEY: ${window.CFG.GMAPS_KEY?.substring(0,10)}...`),window.BookingForm.initializeConfig?(window.BookingForm.initializeConfig(),console.log(`[BookingForm] BookingForm.CONFIG.googleApiKey: ${window.BookingForm.CONFIG.googleApiKey?.substring(0,10)}...`)):window.BookingForm.CONFIG&&(window.BookingForm.CONFIG.googleApiKey=window.CFG.GMAPS_KEY,window.BookingForm.CONFIG.countries=window.CFG.COUNTRIES,window.CFG.PLACES&&(window.BookingForm.CONFIG.places={...window.BookingForm.CONFIG.places,fields:window.CFG.PLACES.FIELDS||window.BookingForm.CONFIG.places.fields,types:window.CFG.PLACES.TYPES||window.BookingForm.CONFIG.places.types,priorityKeywords:window.CFG.PLACES.PRIORITY_KEYWORDS||window.BookingForm.CONFIG.places.priorityKeywords}),console.log(`[BookingForm] Directly updated CONFIG.googleApiKey: ${window.BookingForm.CONFIG.googleApiKey?.substring(0,10)}...`)),window.BookingForm.configReady=!0,window.BookingForm.initializeConfig&&(window.BookingForm.initializeConfig(),console.log(`[BookingForm] Re-initialized CONFIG with API key: ${window.BookingForm.CONFIG.googleApiKey?.substring(0,10)}...`)),window.BookingForm.onConfigReady&&(window.BookingForm.onConfigReady.forEach(n=>n()),window.BookingForm.onConfigReady=[]),window.BookingForm.enhance&&window.BookingForm.enhance()}catch(n){console.error("[BookingForm] Configuration loading failed:",n),window.BookingForm.configReady=!0,window.BookingForm.enhance&&window.BookingForm.enhance()}}window.BookingForm.initializeWithConfig=S;window.BookingForm.loadClientConfiguration=q;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S();window.BookingForm=window.BookingForm||{};function L(){window.BookingForm.CONFIG={googleApiKey:window.CFG&&(window.CFG.GMAPS_KEY||window.CFG.PLACES_API_KEY)||"",countries:(()=>{let n=window.CFG?.COUNTRIES??window.CFG?.COUNTRY??null;return n?(Array.isArray(n)?n:[n]).map(t=>String(t).toUpperCase()):null})(),places:{fields:window.CFG?.PLACES?.FIELDS||["place_id","formatted_address","geometry","name","types"],types:window.CFG?.PLACES?.TYPES??null,boundsRect:(()=>{let n=window.CFG?.PLACES?.BOUNDS;return!n?.sw||!n?.ne?null:{sw:n.sw,ne:n.ne}})(),biasCircle:window.CFG?.PLACES?.BIAS_CENTER||null,airportCodes:window.CFG?.PLACES?.AIRPORT_CODES||{},priorityKeywords:window.CFG?.PLACES?.PRIORITY_KEYWORDS||null,filter:{minKeep:3,addressMustHaveNumber:!0,allowKeywords:(window.CFG?.PLACES?.FILTER?.ALLOW_KEYWORDS||[]).map(n=>String(n).toLowerCase())}},geolocationTimeoutMs:8e3,mapsLoadTimeoutMs:1e4,time:{start:"00:00",end:"23:59",stepMinutes:15,format12:!0}}}L();window.BookingForm.initializeConfig=L;window.BookingForm.ALLOWED_TYPES=["geocode","address","establishment","(regions)","(cities)"];window.BookingForm.getAutocompleteTypesFromConfig=function(){let n=window.CFG?.PLACES?.TYPES;if(n===null||Array.isArray(n)&&n.length===0)return;if(n===void 0)return["establishment"];let t=(Array.isArray(n)?n:[n]).filter(s=>window.BookingForm.ALLOWED_TYPES.includes(s));return t.length===0?["establishment"]:t.includes("establishment")?["establishment"]:[t[0]]};window.BookingForm=window.BookingForm||{};function x(n,o){if(document.getElementById(n))return;let t=document.createElement("style");t.id=n,t.textContent=o,document.head.appendChild(t)}window.BookingForm.injectBaselineStyles=function(){x("booking-form-minimal-styles",`
/* Page-level safety styling */
html, body { max-width: 100%; overflow-x: hidden; }
* { box-sizing: border-box; }

/* Font family override for all form elements */
body, input, button, select, textarea {
    font-family: 'Poppins', sans-serif !important;
}

/* Core icon wrapper + input padding */
.icon-field-wrapper{position:relative;display:block;width:100%;}
.icon-field-wrapper .field-icon{position:absolute;left:0.55rem;top:50%;transform:translateY(-50%);display:inline-flex;align-items:center;justify-content:center;pointer-events:none;color:#777;}
.icon-field-wrapper .field-icon svg{width:20px;height:20px;stroke:#777;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;fill:none;}
.icon-field-wrapper > input[data-iconized='1'][data-q],
.icon-field-wrapper > select[data-iconized='1'][data-q]{padding-left:2.3rem !important;}

/* Baseline field styling (inputs + selects share the same metrics) */
input[data-q], select[data-q]{
  display:inline-block !important;
  width:100% !important;
  min-width:200px !important;
  padding:10px 18px 10px 2.25rem !important; /* leaves room for the icon */
  border:2px solid #DDDDDDFF !important;
  box-shadow: 1px 1px 9px 0px #DCDCDCFF !important;
  background:#fff !important;
  line-height:1.4 !important;
  box-sizing:border-box !important;
  min-height:56px !important;
  height:auto !important;
  color:#222 !important;
}
`)};window.BookingForm.injectBaselineStyles();window.BookingForm.enhance=function(){console.log("[BookingForm] Starting form enhancement...")};})();

// Load the base quote-request-form functionality
var TourBooking=(()=>{window.BookingForm=window.BookingForm||{};async function q(){if(console.log("[ConfigLoader] Starting configuration loading..."),window.CFG?.GMAPS_KEY&&window.CFG?.configLoaded)return console.log("[ConfigLoader] Using pre-loaded configuration"),window.CFG;let n=window.CFG?.client||new URLSearchParams(location.search).get("client")||sessionStorage.getItem("client")||"demo",o=window.CFG?.base||"krishnalewin-hash/tourism-ui-kit@main";console.log(`[ConfigLoader] Loading configuration for client: ${n}`),console.log(`[ConfigLoader] Base URL: ${o}`);try{let t;o.startsWith("../")||o.startsWith("./")||o.startsWith("/")?t=`${o}/clients/${n}/core/config.json`:t=`https://cdn.jsdelivr.net/gh/${o}/clients/${n}/core/config.json`,console.log(`[ConfigLoader] Fetching: ${t}`);let s=await fetch(t,{cache:"no-store"});if(s.ok){let e=await s.json();return window.CFG={...window.CFG,...e.FORM_CONFIG,GMAPS_KEY:e.FORM_CONFIG?.GMAPS_KEY,COUNTRIES:e.FORM_CONFIG?.COUNTRIES,CURRENCY:e.FORM_CONFIG?.CURRENCY,PLACES:e.FORM_CONFIG?.PLACES,FIELD_MAPPING:e.FORM_CONFIG?.FIELD_MAPPING,configLoaded:!0,loadedFrom:"built-config"},console.log(`[ConfigLoader] Successfully loaded ${n} configuration from built config`),window.CFG}else console.log(`[ConfigLoader] Built config returned ${s.status}: ${s.statusText}`)}catch(t){console.log(`[ConfigLoader] Built config fetch failed: ${t.message}`)}try{let t;o.startsWith("../")||o.startsWith("./")||o.startsWith("/")?t=`${o}/clients/${n}.json`:t=`https://cdn.jsdelivr.net/gh/${o}/clients/${n}.json`,console.log(`[ConfigLoader] Trying legacy config: ${t}`);let s=await fetch(t,{cache:"no-store"});if(s.ok){let e=await s.json();return window.CFG={...window.CFG,...e.FORM_CONFIG,GMAPS_KEY:e.FORM_CONFIG?.GMAPS_KEY,COUNTRIES:e.FORM_CONFIG?.COUNTRIES,CURRENCY:e.FORM_CONFIG?.CURRENCY,PLACES:e.FORM_CONFIG?.PLACES,FIELD_MAPPING:e.FORM_CONFIG?.FIELD_MAPPING,configLoaded:!0,loadedFrom:"legacy-config"},console.log(`[ConfigLoader] Successfully loaded ${n} configuration from legacy config`),window.CFG}else console.log(`[ConfigLoader] Legacy config returned ${s.status}: ${s.statusText}`)}catch(t){console.log(`[ConfigLoader] Legacy config fetch failed: ${t.message}`)}return console.warn(`[ConfigLoader] No configuration found for ${n}, using defaults`),window.CFG={...window.CFG,GMAPS_KEY:window.CFG?.GMAPS_KEY||"AIzaSyD4gsEcGYTjqAILBU0z3ZNqEwyODGymXjA",COUNTRIES:window.CFG?.COUNTRIES||["jm"],CURRENCY:window.CFG?.CURRENCY||"USD",PLACES:{FIELDS:["place_id","formatted_address","geometry","name","types"],TYPES:["establishment"],...window.CFG?.PLACES||{}},configLoaded:!0,loadedFrom:"defaults"},window.CFG}async function S(){try{await q(),console.log(`[BookingForm] Configuration loaded from: ${window.CFG.loadedFrom}`),console.log(`[BookingForm] GMAPS_KEY: ${window.CFG.GMAPS_KEY?.substring(0,10)}...`),window.BookingForm.initializeConfig?(window.BookingForm.initializeConfig(),console.log(`[BookingForm] BookingForm.CONFIG.googleApiKey: ${window.BookingForm.CONFIG.googleApiKey?.substring(0,10)}...`)):window.BookingForm.CONFIG&&(window.BookingForm.CONFIG.googleApiKey=window.CFG.GMAPS_KEY,window.BookingForm.CONFIG.countries=window.CFG.COUNTRIES,window.CFG.PLACES&&(window.BookingForm.CONFIG.places={...window.BookingForm.CONFIG.places,fields:window.CFG.PLACES.FIELDS||window.BookingForm.CONFIG.places.fields,types:window.CFG.PLACES.TYPES||window.BookingForm.CONFIG.places.types,priorityKeywords:window.CFG.PLACES.PRIORITY_KEYWORDS||window.BookingForm.CONFIG.places.priorityKeywords}),console.log(`[BookingForm] Directly updated CONFIG.googleApiKey: ${window.BookingForm.CONFIG.googleApiKey?.substring(0,10)}...`)),window.BookingForm.configReady=!0,window.BookingForm.initializeConfig&&(window.BookingForm.initializeConfig(),console.log(`[BookingForm] Re-initialized CONFIG with API key: ${window.BookingForm.CONFIG.googleApiKey?.substring(0,10)}...`)),window.BookingForm.onConfigReady&&(window.BookingForm.onConfigReady.forEach(n=>n()),window.BookingForm.onConfigReady=[]),window.BookingForm.enhance&&window.BookingForm.enhance()}catch(n){console.error("[BookingForm] Configuration loading failed:",n),window.BookingForm.configReady=!0,window.BookingForm.enhance&&window.BookingForm.enhance()}}window.BookingForm.initializeWithConfig=S;window.BookingForm.loadClientConfiguration=q;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S();window.BookingForm=window.BookingForm||{};function L(){window.BookingForm.CONFIG={googleApiKey:window.CFG&&(window.CFG.GMAPS_KEY||window.CFG.PLACES_API_KEY)||"",countries:(()=>{let n=window.CFG?.COUNTRIES??window.CFG?.COUNTRY??null;return n?(Array.isArray(n)?n:[n]).map(t=>String(t).toUpperCase()):null})(),places:{fields:window.CFG?.PLACES?.FIELDS||["place_id","formatted_address","geometry","name","types"],types:window.CFG?.PLACES?.TYPES??null,boundsRect:(()=>{let n=window.CFG?.PLACES?.BOUNDS;return!n?.sw||!n?.ne?null:{sw:n.sw,ne:n.ne}})(),biasCircle:window.CFG?.PLACES?.BIAS_CENTER||null,airportCodes:window.CFG?.PLACES?.AIRPORT_CODES||{},priorityKeywords:window.CFG?.PLACES?.PRIORITY_KEYWORDS||null,filter:{minKeep:3,addressMustHaveNumber:!0,allowKeywords:(window.CFG?.PLACES?.FILTER?.ALLOW_KEYWORDS||[]).map(n=>String(n).toLowerCase())}},geolocationTimeoutMs:8e3,mapsLoadTimeoutMs:1e4,time:{start:"00:00",end:"23:59",stepMinutes:15,format12:!0}}}L();window.BookingForm.initializeConfig=L;window.BookingForm.ALLOWED_TYPES=["geocode","address","establishment","(regions)","(cities)"];window.BookingForm.getAutocompleteTypesFromConfig=function(){let n=window.CFG?.PLACES?.TYPES;if(n===null||Array.isArray(n)&&n.length===0)return;if(n===void 0)return["establishment"];let t=(Array.isArray(n)?n:[n]).filter(s=>window.BookingForm.ALLOWED_TYPES.includes(s));return t.length===0?["establishment"]:t.includes("establishment")?["establishment"]:[t[0]]};window.BookingForm=window.BookingForm||{};function x(n,o){if(document.getElementById(n))return;let t=document.createElement("style");t.id=n,t.textContent=o,document.head.appendChild(t)}window.BookingForm.injectBaselineStyles=function(){x("booking-form-minimal-styles",`
/* Page-level safety styling */
html, body { max-width: 100%; overflow-x: hidden; }
* { box-sizing: border-box; }

/* Font family override for all form elements */
body, input, button, select, textarea {
    font-family: 'Poppins', sans-serif !important;
}

/* Core icon wrapper + input padding */
.icon-field-wrapper{position:relative;display:block;width:100%;}
.icon-field-wrapper .field-icon{position:absolute;left:0.55rem;top:50%;transform:translateY(-50%);display:inline-flex;align-items:center;justify-content:center;pointer-events:none;color:#777;}
.icon-field-wrapper .field-icon svg{width:20px;height:20px;stroke:#777;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;fill:none;}
.icon-field-wrapper > input[data-iconized='1'][data-q],
.icon-field-wrapper > select[data-iconized='1'][data-q]{padding-left:2.3rem !important;}

/* Baseline field styling (inputs + selects share the same metrics) */
input[data-q], select[data-q]{
  display:inline-block !important;
  width:100% !important;
  padding:0.75rem 0.7rem !important;
  font-size:1.05rem !important;
  line-height:1.3 !important;
  border:1px solid #ccc !important;
  border-radius:8px !important;
  background-color:#fff !important;
  color:#333 !important;
  font-family:'Poppins',sans-serif !important;
  font-weight:400 !important;
  outline:none !important;
  transition:border-color 0.15s ease-in-out,box-shadow 0.15s ease-in-out !important;
}

input[data-q]:focus, select[data-q]:focus {
  border-color:#80bdff !important;
  box-shadow:0 0 0 0.2rem rgba(0,123,255,.25) !important;
}

/* Error state styling */
.input-error {
  border-color: #dc3545 !important;
  box-shadow: 0 0 0 0.2rem rgba(220,53,69,.25) !important;
}

.field-error {
  color: #dc3545;
  font-size: 0.875rem;
  margin-top: 0.25rem;
  display: block;
}

/* Animation classes for form transitions */
.bf-fade-anim {
  transition: opacity 0.23s ease-in-out;
}

.bf-fade-out {
  opacity: 0.3;
}

/* Shake animation for validation errors */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
  20%, 40%, 60%, 80% { transform: translateX(4px); }
}

.shake {
  animation: shake 0.5s ease-in-out;
}

/* Mobile-responsive NEXT button styling */
@media (max-width: 768px) {
  .ghl-btn.ghl-footer-next.bf-next {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 0.5rem !important;
  }
  
  .bf-next-label {
    font-weight: 600;
    font-size: 0.95rem;
  }
}

/* Submit button enhancement */
.ghl-btn.ghl-submit-btn.bf-cta {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 0.75rem !important;
  min-height: 50px !important;
}

.bf-cta-text {
  font-weight: 700 !important;
  font-size: 1.1rem !important;
}

.bf-arrow {
  display: inline-flex !important;
  align-items: center !important;
}

.bf-arrow svg {
  width: 20px !important;
  height: 20px !important;
  stroke: currentColor !important;
  fill: none !important;
}

/* Time picker popover */
#pickup-time-popover {
  font-family: 'Poppins', sans-serif !important;
}

/* Date picker popover */
#pickup-date-popover {
  position: absolute;
  z-index: 2147483647;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
  padding: 16px;
  display: none;
  min-width: 280px;
  font-family: 'Poppins', sans-serif;
  user-select: none;
}

.dp-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  font-weight: 600;
  font-size: 1.1rem;
}

.dp-nav {
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  transition: background-color 0.2s;
}

.dp-nav:hover {
  background-color: #f0f0f0;
}

.dp-weekdays {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px;
  margin-bottom: 8px;
}

.dp-weekdays > div {
  padding: 8px 4px;
  text-align: center;
  font-weight: 600;
  font-size: 0.85rem;
  color: #666;
}

.dp-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 2px;
}

.dp-day {
  padding: 10px 4px;
  text-align: center;
  cursor: pointer;
  border-radius: 6px;
  transition: all 0.2s;
  font-size: 0.95rem;
}

.dp-day:hover:not(.dp-disabled) {
  background-color: #e3f2fd;
}

.dp-day.dp-today {
  background-color: #2196f3;
  color: white;
  font-weight: 600;
}

.dp-day.dp-disabled {
  color: #ccc;
  cursor: not-allowed;
}

`)};window.BookingForm.injectBaselineStyles();
/* Enhanced booking form JS logic continues... */