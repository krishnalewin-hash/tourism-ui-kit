var FormEnhancer=(()=>{var c=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var h=(o,e)=>{for(var n in e)c(o,n,{get:e[n],enumerable:!0})},f=(o,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of d(e))!p.call(o,i)&&i!==n&&c(o,i,{get:()=>e[i],enumerable:!(t=l(e,i))||t.enumerable});return o};var u=o=>f(c({},"__esModule",{value:!0}),o);var m={};h(m,{default:()=>g});var a=class{constructor(){this.config=null,this.placesService=null,this.isInitialized=!1}async initialize(){if(!this.isInitialized)try{let e=window.CFG?.client||"demo",n=window.CFG?.base||"krishnalewin-hash/tourism-ui-kit@main",t=await fetch(`https://cdn.jsdelivr.net/gh/${n}/clients/${e}.json`);if(this.config=await t.json(),!this.config.FORM_CONFIG){console.warn("No FORM_CONFIG found for client:",e);return}await this.loadGoogleMaps(),await this.enhanceForm(),this.isInitialized=!0,console.log("Form enhancer initialized for client:",e)}catch(e){console.error("Failed to initialize form enhancer:",e)}}async loadGoogleMaps(){if(window.google?.maps)return;let e=this.config.FORM_CONFIG.GMAPS_KEY;if(!e){console.warn("No Google Maps API key configured");return}let n=document.createElement("script");return n.src=`https://maps.googleapis.com/maps/api/js?key=${e}&libraries=places`,n.async=!0,n.defer=!0,new Promise((t,i)=>{n.onload=t,n.onerror=i,document.head.appendChild(n)})}async enhanceForm(){if(!window.google?.maps)return;let e=this.config.FORM_CONFIG.FIELD_MAPPING,n=this.config.FORM_CONFIG.PLACES;this.enhanceLocationField(e.pickup_location,"pickup",n),this.enhanceLocationField(e.dropoff_location,"dropoff",n),this.addFieldIcons(),this.setupDataPersistence(),this.restoreSavedData()}enhanceLocationField(e,n,t){let i=this.findField(e);if(!i)return;let r=new google.maps.places.Autocomplete(i,{fields:t.FIELDS,types:t.TYPES,componentRestrictions:{country:this.config.FORM_CONFIG.COUNTRIES}});r.addListener("place_changed",()=>{let s=r.getPlace();s.geometry&&this.saveFieldData(n+"_location",{address:s.formatted_address,name:s.name,place_id:s.place_id,types:s.types,lat:s.geometry.location.lat(),lng:s.geometry.location.lng()})})}findField(e){for(let n of e){let t=document.querySelector(n);if(t)return t}return null}addFieldIcons(){let e={pickup_location:this.getMapPinIcon(),dropoff_location:this.getMapPinIcon(),pickup_date:this.getCalendarIcon(),pickup_time:this.getClockIcon(),passengers:this.getUsersIcon()};Object.entries(this.config.FORM_CONFIG.FIELD_MAPPING).forEach(([n,t])=>{let i=this.findField(t),r=e[n];i&&r&&!i.parentElement.querySelector(".field-icon")&&this.addIcon(i,r)})}addIcon(e,n){let t=document.createElement("div");t.style.position="relative",t.style.display="inline-block",t.style.width="100%",e.parentNode.insertBefore(t,e),t.appendChild(e);let i=document.createElement("div");i.className="field-icon",i.innerHTML=n,i.style.cssText=`
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      z-index: 1;
      opacity: 0.6;
    `,t.appendChild(i),e.style.paddingLeft="40px"}getMapPinIcon(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path><circle cx="12" cy="10" r="3"></circle></svg>'}getCalendarIcon(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>'}getClockIcon(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12,6 12,12 16,14"></polyline></svg>'}getUsersIcon(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>'}setupDataPersistence(){document.querySelector("form")&&Object.entries(this.config.FORM_CONFIG.FIELD_MAPPING).forEach(([n,t])=>{let i=this.findField(t);i&&(i.addEventListener("input",()=>{this.saveFieldData(n,i.value)}),i.addEventListener("change",()=>{this.saveFieldData(n,i.value)}))})}saveFieldData(e,n){try{let t=JSON.parse(sessionStorage.getItem("transfer:last")||"{}");t[e]=n,t.timestamp=Date.now(),t.client=window.CFG?.client||"demo",sessionStorage.setItem("transfer:last",JSON.stringify(t))}catch(t){console.warn("Failed to save form data:",t)}}restoreSavedData(){try{let e=JSON.parse(sessionStorage.getItem("transfer:last")||"{}");Object.entries(this.config.FORM_CONFIG.FIELD_MAPPING).forEach(([n,t])=>{let i=this.findField(t),r=e[n];i&&r&&typeof r=="string"&&(i.value=r)})}catch(e){console.warn("Failed to restore form data:",e)}}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new a().initialize()}):new a().initialize();var g=a;return u(m);})();
