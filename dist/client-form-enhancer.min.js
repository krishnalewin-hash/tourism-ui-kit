var ClientFormEnhancer=(()=>{(function(){"use strict";let d=!1,s=null;async function h(){try{let e=window.CLIENT_ID||"demo",n=`https://cdn.jsdelivr.net/gh/${window.BASE_URL||"krishnalewin-hash/tourism-ui-kit@main"}/clients/${e}.json`,t=await fetch(n);if(!t.ok)throw new Error(`Failed to load client config: ${t.status}`);return s=await t.json(),s.WINDOW_CFG?(window.CFG=s.WINDOW_CFG,console.log(`Loaded config for client: ${e}`),!0):(console.warn(`No WINDOW_CFG found for client: ${e}`),!1)}catch(e){return console.error("Failed to load client config:",e),!1}}async function _(){if(window.google?.maps)return;if(!window.CFG||!window.CFG.GMAPS_KEY){console.warn("Form enhancer: No window.CFG.GMAPS_KEY found");return}let e=document.createElement("script");return e.src=`https://maps.googleapis.com/maps/api/js?key=${window.CFG.GMAPS_KEY}&libraries=places`,e.async=!0,e.defer=!0,new Promise((i,n)=>{e.onload=i,e.onerror=n,document.head.appendChild(e)})}async function w(){if(d||!window.google?.maps||!window.CFG)return;let e=window.CFG.PLACES||{};p(['[data-q="pickup_location"]','[name="pickup_location"]'],"pickup_location",e),p(['[data-q="drop-off_location"]','[name="drop-off_location"]','[name="dropoff_location"]'],"dropoff_location",e),k(),C(),d=!0,console.log("Client-aware form enhancer initialized successfully")}function p(e,i,n){let t=y(e);if(!t)return;let a=new google.maps.places.Autocomplete(t,{fields:n.FIELDS||["place_id","formatted_address","geometry","name","types"],types:n.TYPES||["establishment"],componentRestrictions:{country:window.CFG.COUNTRIES||["jm"]}});a.addListener("place_changed",()=>{let o=a.getPlace();o.geometry&&F(i,{address:o.formatted_address,name:o.name,place_id:o.place_id,types:o.types,lat:o.geometry.location.lat(),lng:o.geometry.location.lng()})})}function y(e){for(let i of e){let n=document.querySelector(i);if(n)return n}return null}function k(){let e={'[data-q="pickup_location"]':r(),'[name="pickup_location"]':r(),'[data-q="drop-off_location"]':r(),'[name="drop-off_location"]':r(),'[name="dropoff_location"]':r(),'[data-q="pickup_date"]':u(),'[name="pickup_date"]':u(),'[data-q="pickup_time"]':f(),'[name="pickup_time"]':f(),'[data-q="number_of_passengers"]':m(),'[name="number_of_passengers"]':m()};Object.entries(e).forEach(([i,n])=>{let t=document.querySelector(i);t&&!t.parentElement.querySelector(".field-icon")&&v(t,n)})}function v(e,i){let n=document.createElement("div");n.style.position="relative",n.style.display="inline-block",n.style.width="100%",e.parentNode.insertBefore(n,e),n.appendChild(e);let t=document.createElement("div");t.className="field-icon",t.innerHTML=i,t.style.cssText=`
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      z-index: 1;
      opacity: 0.6;
    `,n.appendChild(t),e.style.paddingLeft="40px"}function r(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path><circle cx="12" cy="10" r="3"></circle></svg>'}function u(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>'}function f(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12,6 12,12 16,14"></polyline></svg>'}function m(){return'<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>'}function C(){let e="transfer:last",i={pickup_location:['[data-q="pickup_location"]','[name="pickup_location"]'],dropoff_location:['[data-q="drop-off_location"]','[name="drop-off_location"]','[name="dropoff_location"]'],pickup_date:['[data-q="pickup_date"]','[name="pickup_date"]'],pickup_time:['[data-q="pickup_time"]','[name="pickup_time"]'],passengers:['select[data-q="number_of_passengers"]','[name="number_of_passengers"]','[data-q="number_of_passengers"]'],first_name:['[name="first_name"]','[data-q="full_name"]'],last_name:['[name="last_name"]'],email:['[name="email"]'],phone:['[name="phone"]']};function n(o){for(let c of o){let l=document.querySelector(c);if(l&&typeof l.value<"u")return l.value.trim()}return""}function t(){let o={};for(let c of Object.keys(i))o[c]=n(i[c]);return o}function a(){try{let o=t();sessionStorage.setItem(e,JSON.stringify(o))}catch{}}document.addEventListener("input",a,!0),document.addEventListener("change",a,!0),document.addEventListener("click",o=>{o.target.closest?.(".ghl-btn.ghl-footer-next, .ghl-btn.ghl-submit-btn")&&a()},!0),window.addEventListener("beforeunload",a)}function F(e,i){try{let n=JSON.parse(sessionStorage.getItem("transfer:last")||"{}");n[e]=i,n.timestamp=Date.now(),sessionStorage.setItem("transfer:last",JSON.stringify(n))}catch(n){console.warn("Failed to save form data:",n)}}async function g(){try{if(!await h()){console.error("Failed to load client configuration");return}await _(),setTimeout(w,1e3)}catch(e){console.error("Failed to initialize client-aware form enhancer:",e)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g()})();})();
